rules_version = '2';
service firebase.storage {
  match /b/{bucket}/o {
    // Block all direct client access to the private proofs folder.
    // Uploads are handled via Cloud Functions (Admin SDK), so no 'write' rule is needed here for clients.
    // Downloads are handled via Signed URLs generated by Cloud Functions.
    match /private/proofs/{allPaths=**} {
      allow read, write: if false;
    }
    
    // Allow profile photos if needed (example public read)
    match /public/{allPaths=**} {
      allow read: if true;
      allow write: if request.auth != null;
    }
  }
}